# BA-Agent é¡¹ç›®è®°å¿†

> æœ¬æ–‡ä»¶æ˜¯ BA-Agent çš„é¡¹ç›®çº§è®°å¿†ï¼ˆLayer 3: Context Bootstrapï¼‰
> å›¢é˜Ÿå…±äº«çŸ¥è¯†ï¼ŒåŒ…å«åœ¨ Git ç‰ˆæœ¬æ§åˆ¶ä¸­

## é¡¹ç›®æ¦‚è¿°

BA-Agent (Business Analysis Agent) æ˜¯ä¸€ä¸ªå•†ä¸šåˆ†æåŠ©æ‰‹ Agentï¼Œé¢å‘éæŠ€æœ¯ä¸šåŠ¡äººå‘˜ã€‚

**ç›®æ ‡ç”¨æˆ·**ï¼šè·¨å¢ƒç”µå•†ä¼ä¸šçš„ä¸šåŠ¡åˆ†æå¸ˆã€è¿è¥äººå‘˜
**æ ¸å¿ƒä»·å€¼**ï¼šé€šè¿‡è‡ªç„¶è¯­è¨€å¯¹è¯å®Œæˆæ•°æ®å¼‚åŠ¨æ£€æµ‹ã€å½’å› åˆ†æã€æŠ¥å‘Šç”Ÿæˆã€æ•°æ®å¯è§†åŒ–

## æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BA-Agent æ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend: IM Bot (ä¼ä¸šå¾®ä¿¡/é’‰é’‰) + Excel æ’ä»¶              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  API Layer: FastAPI (Python)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Agent Layer: LangGraph Agent + Claude 3.5 Sonnet           â”‚
â”‚  â”œâ”€ System Prompt (AGENTS.md)                               â”‚
â”‚  â”œâ”€ Memory Management (ä¸‰å±‚è®°å¿†)                            â”‚
â”‚  â””â”€ Tool Invocation (langchain.agents.create_agent)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Tools Layer (8ä¸ªåŸºç¡€å·¥å…·)                                  â”‚
â”‚  â”œâ”€ execute_command (Dockeréš”ç¦»)                            â”‚
â”‚  â”œâ”€ run_python (Dockeréš”ç¦»ï¼Œæ ¸å¿ƒ)                           â”‚
â”‚  â”œâ”€ web_search (MCP: mcp__web-search-prime__webSearchPrime) â”‚
â”‚  â”œâ”€ read_webpage (MCP: mcp__web_reader__webReader)          â”‚
â”‚  â”œâ”€ read_file (CSV/Excel/JSON/æ–‡æœ¬)                         â”‚
â”‚  â”œâ”€ query_database (SQLAlchemy)                             â”‚
â”‚  â”œâ”€ search_knowledge (Chromaå‘é‡æ£€ç´¢)                       â”‚
â”‚  â””â”€ invoke_skill (è°ƒç”¨å¯é…ç½®Skills)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Skills Layer (å¯é…ç½®åˆ†æSkills)                            â”‚
â”‚  â”œâ”€ anomaly_detection (å¼‚åŠ¨æ£€æµ‹)                            â”‚
â”‚  â”œâ”€ attribution (å½’å› åˆ†æ)                                  â”‚
â”‚  â”œâ”€ report_gen (æŠ¥å‘Šç”Ÿæˆ)                                   â”‚
â”‚  â””â”€ visualization (æ•°æ®å¯è§†åŒ–ï¼ŒECharts)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Data Layer                                                  â”‚
â”‚  â”œâ”€ PostgreSQL (ä¸»æ•°æ®åº“)                                   â”‚
â”‚  â”œâ”€ ClickHouse (å¤§æ•°æ®åˆ†æ)                                 â”‚
â”‚  â””â”€ Chroma (å‘é‡æ•°æ®åº“ï¼ŒçŸ¥è¯†æ£€ç´¢)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ ¸å¿ƒæŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| LLM | Claude (Anthropic) | 3.5 Sonnet |
| Agent æ¡†æ¶ | LangGraph | >=1.0.7 |
| å·¥å…·æ¡†æ¶ | LangChain Core | >=1.2.0 |
| API æ¡†æ¶ | FastAPI | >=0.115.0 |
| æ•°æ®åˆ†æ | pandas, numpy, scipy | æœ€æ–° |
| ç§‘å­¦ç»Ÿè®¡ | statsmodels, scikit-learn | æœ€æ–° |
| Excel å¤„ç† | openpyxl, xlrd, xlsxwriter | æœ€æ–° |
| å‘é‡æ•°æ®åº“ | Chroma | (Python 3.14 ARM64 æš‚ä¸æ”¯æŒ) |

## é‡è¦è®¾è®¡å†³ç­–

### API é€‰æ‹© (2025-02-04)
- **Agent åˆ›å»º**: ä½¿ç”¨ `langchain.agents.create_agent` (LangChain 1.2.8+ æ¨èæ–¹å¼)
- **å·¥å…·å®šä¹‰**: ä½¿ç”¨ `langchain_core.tools.StructuredTool`
- **è®°å¿†ç®¡ç†**: ä½¿ç”¨ `langgraph.checkpoint.memory.MemorySaver` æ”¯æŒå¯¹è¯å†å²

### MCP å·¥å…·é›†æˆ (2025-02-04)
- **Web æœç´¢**: ä½¿ç”¨ `mcp__web-search-prime__webSearchPrime` (Z.ai MCP)
- **Web è¯»å–**: ä½¿ç”¨ `mcp__web_reader__webReader` (Z.ai MCP)

### æ•°æ®å¯è§†åŒ–æ–¹æ¡ˆ (2025-02-04)
- **æ–¹æ¡ˆ**: ECharts (é€šè¿‡ Gemini 3 Pro ç”Ÿæˆä»£ç ï¼Œå‰ç«¯æ¸²æŸ“)
- **åŸå› **: äº¤äº’æ€§å¼ºã€ä¸­æ–‡æ”¯æŒå¥½ã€æ— éœ€ Python å›¾è¡¨åº“

### Python ç‰ˆæœ¬é™åˆ¶ (2025-02-04)
- **å½“å‰**: Python 3.12 ARM64
- **å·²çŸ¥é—®é¢˜**: Python 3.14 ARM64 æš‚ä¸æ”¯æŒ chromadb (ç¼ºå°‘ onnxruntime)

## ä¸‰å±‚è®°å¿†ç®¡ç†

æ¯æ¬¡ä¼šè¯å¼€å§‹æ—¶ï¼ŒAgent æŒ‰ä»¥ä¸‹é¡ºåºåŠ è½½è®°å¿†ï¼š

1. **è¯»å– `AGENTS.md`** - Agent ç³»ç»ŸæŒ‡ä»¤å’Œè®°å¿†æŒ‡å—
2. **è¯»å– `USER.md`** - ç”¨æˆ·ä¿¡æ¯å’Œåå¥½
3. **è¯»å– `MEMORY.md`** - é•¿æœŸç­–åˆ’çŸ¥è¯†
4. **è¯»å– `memory/YYYY-MM-DD.md`** (ä»Šå¤©å’Œæ˜¨å¤©) - æœ€è¿‘ä¸Šä¸‹æ–‡

### è®°å¿†å†™å…¥è§„åˆ™

| è§¦å‘æ¡ä»¶ | ç›®æ ‡ä½ç½® | ç¤ºä¾‹ |
|----------|----------|------|
| æ—¥å¸¸ç¬”è®°ã€"è®°ä½è¿™ä¸ª" | `memory/YYYY-MM-DD.md` | "è®¨è®ºäº† API è®¾è®¡" |
| æŒä¹…äº‹å®ã€åå¥½ã€å†³ç­– | `MEMORY.md` | "ç”¨æˆ·åå¥½ TypeScript" |
| é‡è¦é‡Œç¨‹ç¢‘ | `CLAUDE.md` | "å®Œæˆ API é‡æ„" |

## è®°å¿†ç®¡ç†å·¥å…·

Agent å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·ç®¡ç†è®°å¿†ï¼š

- **`memory_search`**: è¯­ä¹‰æœç´¢ MEMORY.md + memory/*.md
- **`memory_get`**: è¯»å–ç‰¹å®šå†…å­˜æ–‡ä»¶çš„ç‰¹å®šè¡Œ
- **`memory_write`**: å†™å…¥è®°å¿†ï¼ˆè‡ªåŠ¨é€‰æ‹© Layer 1 æˆ– Layer 2ï¼‰

## å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼
- æ‰€æœ‰å‡½æ•°å¿…é¡»æœ‰ç±»å‹æ³¨è§£
- å¤æ‚é€»è¾‘å¿…é¡»æœ‰æ–‡æ¡£å­—ç¬¦ä¸²
- æ‰€æœ‰å¤–éƒ¨è°ƒç”¨å¿…é¡»æœ‰é”™è¯¯å¤„ç†

### å®‰å…¨è¦æ±‚
- Docker å®¹å™¨å¿…é¡»æœ‰èµ„æºé™åˆ¶
- å‘½ä»¤è¡Œå’Œ Python æ‰§è¡Œå¿…é¡»æœ‰ç™½åå•
- SQL æŸ¥è¯¢å¿…é¡»å‚æ•°åŒ–é˜²æ­¢æ³¨å…¥

### æµ‹è¯•è¦æ±‚
- æ¯ä¸ªå·¥å…·å¿…é¡»æœ‰å•å…ƒæµ‹è¯•
- æ¯ä¸ª Skill å¿…é¡»æœ‰å•å…ƒæµ‹è¯•
- Agent éœ€è¦ç«¯åˆ°ç«¯æµ‹è¯•
- æµ‹è¯•è¦†ç›–ç‡ > 80%

## å½“å‰è¿›åº¦

æŸ¥çœ‹ `scripts/ralph/progress.txt` è·å–è¯¦ç»†è¿›åº¦ã€‚

**å·²å®Œæˆ**:
- âœ… US-001: é¡¹ç›®åˆå§‹åŒ–
- âœ… ä¾èµ–å®‰è£…å’Œ LangChain 1.2.x API ä¿®å¤

**è¿›è¡Œä¸­**:
- ğŸ”„ US-002: æ ¸å¿ƒæ•°æ®æ¨¡å‹å®šä¹‰ (Pydantic)

**å¾…å¼€å§‹**:
- â³ US-003: é…ç½®ç®¡ç†ç³»ç»Ÿ
- â³ US-004: LangGraph Agent åŸºç¡€æ¡†æ¶
- ... (è¯¦è§ prd.json)

## å‚è€ƒèµ„æ–™

- [LangChain 1.2.x æ–‡æ¡£](https://python.langchain.com/docs/tutorials/agents/)
- [Claude API æ–‡æ¡£](https://docs.anthropic.com/)
- [Manus AI - Planning with Files](https://github.com/OthmanAdi/planning-with-files)
- [Clawdbot Memory Architecture](https://manthanguptaa.in/posts/clawdbot_memory/)
