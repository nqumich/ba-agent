# BA-Agent æŠ€æœ¯æ¶æ„æ–‡æ¡£

> **ç‰ˆæœ¬**: v2.3.0
> **æœ€åæ›´æ–°**: 2026-02-08
> **å¼€å‘è¿›åº¦**: ~88% (26/30 User Stories å®Œæˆ)
> **æµ‹è¯•çŠ¶æ€**: 1030/1030 é€šè¿‡

äº§å“éœ€æ±‚è¯·å‚é˜… [README.md](README.md)

---

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿° BA-Agent çš„æŠ€æœ¯æ¶æ„è®¾è®¡ã€ç»„ä»¶å®ç°å’Œå¼€å‘çŠ¶æ€ã€‚

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡åŸåˆ™

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

1. **å• Agent + Pipeline v2.1 + å¯é…ç½® Skills**
   - ä¸€ä¸ªä¸» Agent (LangGraph)
   - Pipeline v2.1: ç»Ÿä¸€å·¥å…·è¾“å‡ºæ ¼å¼ (ToolExecutionResult)
   - åŸºç¡€å·¥å…·ï¼šexecute_command, run_python, web_search, web_reader, file_reader, file_write, query_database, search_knowledge
   - Skills é€šè¿‡é…ç½®æ³¨å†Œï¼Œå¯åŠ¨æ€æ‰©å±•

2. **Agent Loop è¿­ä»£**
   - æ¯æ¬¡å¾ªç¯ï¼šAnalyze â†’ Plan â†’ Execute â†’ Observe
   - æŒç»­è¿­ä»£ç›´åˆ°ä»»åŠ¡å®Œæˆ

3. **Python æ²™ç›’æ˜¯æ ¸å¿ƒ**
   - æ‰€æœ‰åˆ†æèƒ½åŠ›é€šè¿‡ Python + Claude Skill å®ç°
   - æœ¬åœ° Docker éš”ç¦»ç¯å¢ƒæ›¿ä»£äº‘ç«¯è™šæ‹Ÿæœº

4. **Skills å¯é…ç½®**
   - ç”¨æˆ·å¯ä»¥æ·»åŠ è‡ªå®šä¹‰ Skills
   - Skills é€šè¿‡ YAML é…ç½®æ–‡ä»¶æ³¨å†Œ
   - Agent é€šè¿‡ `invoke_skill` å·¥å…·è°ƒç”¨

5. **Pipeline v2.1.0 ç‰¹æ€§**
   - **OutputLevel**: BRIEF/STANDARD/FULL ä¸‰çº§è¾“å‡ºæ§åˆ¶
   - **ToolCachePolicy**: ç¼“å­˜ç­–ç•¥ç®¡ç†
   - **DynamicTokenCounter**: ç²¾ç¡®çš„ Token è®¡æ•°
   - **AdvancedContextManager**: æ™ºèƒ½ä¸Šä¸‹æ–‡å‹ç¼©
   - **IdempotencyCache**: è·¨è½®æ¬¡è¯­ä¹‰ç¼“å­˜
   - **ToolTimeoutHandler**: åŒæ­¥è¶…æ—¶æ§åˆ¶

6. **ContextCoordinator åè°ƒå±‚ (v2.3.0 æ–°å¢)**
   - ç»Ÿä¸€çš„ä¸Šä¸‹æ–‡å‡†å¤‡å…¥å£
   - åè°ƒæ–‡ä»¶æ¸…ç†å’Œä¸Šä¸‹æ–‡æ„å»º
   - ç¡®ä¿ç³»ç»Ÿæç¤ºåœ¨ç¬¬ä¸€ä½
   - æ˜ç¡®èŒè´£åˆ’åˆ†ï¼ˆLangGraph ç®¡ç†å†å²ï¼ŒContextManager ç®¡ç†æ¸…ç†ï¼‰

---

## ğŸ¯ æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç”¨æˆ·äº¤äº’å±‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Python API  â”‚  â”‚  Web API     â”‚  â”‚  IM Bot      â”‚  â”‚  Excelæ’ä»¶   â”‚    â”‚
â”‚  â”‚  (å½“å‰å¯ç”¨)  â”‚  â”‚  (å½“å‰å¯ç”¨)  â”‚  â”‚  (è§„åˆ’ä¸­)    â”‚  â”‚  (è§„åˆ’ä¸­)    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       API æœåŠ¡å±‚ (FastAPI)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  JWT è®¤è¯ | é€Ÿç‡é™åˆ¶ | é”™è¯¯å¤„ç† | è¯·æ±‚æ—¥å¿—                              â”‚   â”‚
â”‚  â”‚  BAAgentService (HTTP æ¥å£åŒ…è£…ã€å¯¹è¯ç®¡ç†)                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä¸Šä¸‹æ–‡åè°ƒå±‚ (ContextCoordinator) v2.3.0              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â€¢ prepare_messages() - å‡†å¤‡å‘é€ç»™ LLM çš„æ¶ˆæ¯åˆ—è¡¨                       â”‚   â”‚
â”‚  â”‚  â€¢ åè°ƒæ–‡ä»¶æ¸…ç†å’Œä¸Šä¸‹æ–‡æ„å»º                                              â”‚   â”‚
â”‚  â”‚  â€¢ ç¡®ä¿ç³»ç»Ÿæç¤ºåœ¨ç¬¬ä¸€ä½                                                  â”‚   â”‚
â”‚  â”‚  â€¢ å§”æ‰˜æ–‡ä»¶æ¸…ç†ç»™ ContextManager                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Pipeline v2.1.0           â”‚ â”‚   ContextManager     â”‚ â”‚   LangGraph         â”‚
â”‚  (è¾“å‡ºç®¡ç†å±‚)               â”‚ â”‚   (ä¸Šä¸‹æ–‡ç®¡ç†)        â”‚ â”‚   (çŠ¶æ€ç®¡ç†)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ToolExecutionResult â”‚   â”‚ â”‚  â”‚ clean_langchain â”‚  â”‚ â”‚  â”‚ AgentState     â”‚  â”‚
â”‚  â”‚ OutputLevel         â”‚   â”‚ â”‚  â”‚ _build_context  â”‚  â”‚ â”‚  â”‚ Checkpointer   â”‚  â”‚
â”‚  â”‚ TokenCounter        â”‚   â”‚ â”‚  â”‚ _code_list      â”‚  â”‚ â”‚  â”‚ æ¶ˆæ¯è¿½åŠ        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Agent Loop (LangGraph)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  Analyze â†’ Plan â†’ Execute â†’ Observe                â”‚   â”‚
â”‚  â”‚                  (ReAct Pattern with MemorySaver)                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        åŸºç¡€å·¥å…·å±‚ (v2.1)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚ execute_cmd  â”‚  â”‚ run_python   â”‚  â”‚ web_search   â”‚          â”‚   â”‚
â”‚  â”‚  â”‚(Dockeréš”ç¦») â”‚  â”‚(Dockeréš”ç¦») â”‚  â”‚  (MCP Z.ai)  â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚   â”‚
â”‚  â”‚  â”‚ web_reader   â”‚  â”‚ file_reader  â”‚  â”‚ file_write   â”‚          â”‚   â”‚
â”‚  â”‚  â”‚  (MCP Z.ai)  â”‚  â”‚(å¤šæ ¼å¼æ”¯æŒ)  â”‚  â”‚(ä¸‰ç§æ¨¡å¼)    â”‚          â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚   â”‚
â”‚  â”‚  â”‚ query_db     â”‚  â”‚ search_kb    â”‚                              â”‚   â”‚
â”‚  â”‚  â”‚(SQLAlchemy)  â”‚  â”‚(Chroma/å†…å­˜) â”‚                              â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Skills å±‚ (å¯é…ç½®)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  skills/                                                          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ anomaly_detection/SKILL.md    (å¼‚åŠ¨æ£€æµ‹ - æ¡†æ¶å®Œæˆ)          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ attribution/SKILL.md         (å½’å› åˆ†æ - æ¡†æ¶å®Œæˆ)          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ report_gen/SKILL.md          (æŠ¥å‘Šç”Ÿæˆ - æ¡†æ¶å®Œæˆ)          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ visualization/SKILL.md       (æ•°æ®å¯è§†åŒ– - æ¡†æ¶å®Œæˆ)        â”‚   â”‚
â”‚  â”‚  â””â”€â”€ [ç”¨æˆ·è‡ªå®šä¹‰ Skills...]                                       â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  config/skills.yaml (Skill æ³¨å†Œé…ç½®)                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®ä¸è®°å¿†å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ä¸šåŠ¡æ•°æ®åº“   â”‚  â”‚  æ•°æ®ä»“åº“     â”‚  â”‚  SaaS API    â”‚  â”‚  å‘é‡æ•°æ®åº“   â”‚   â”‚
â”‚  â”‚  (PostgreSQL) â”‚  â”‚ (ClickHouse)  â”‚  â”‚ (ç¬¬ä¸‰æ–¹æ¥å£)  â”‚  â”‚  (Chroma)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ä¸‰å±‚è®°å¿†ç³»ç»Ÿ                                  â”‚   â”‚
â”‚  â”‚  Layer 1: memory/YYYY-MM-DD.md (æ¯æ—¥å¯¹è¯æ—¥å¿—)                   â”‚   â”‚
â”‚  â”‚  Layer 2: MEMORY.md (é•¿æœŸçŸ¥è¯†è®°å¿†)                              â”‚   â”‚
â”‚  â”‚  Layer 3: CLAUDE.md (é¡¹ç›®çº§è®°å¿†)                               â”‚   â”‚
â”‚  â”‚  MemoryFlush (è‡ªåŠ¨æå–) + MemoryWatcher (æ–‡ä»¶ç›‘å¬)              â”‚   â”‚
â”‚  â”‚  MemorySearch (FTS5 + å‘é‡æ··åˆæœç´¢)                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯é€‰å‹ | è¯´æ˜ |
|------|----------|------|
| **APIæ¡†æ¶** | FastAPI | é«˜æ€§èƒ½ã€å¼‚æ­¥æ”¯æŒã€è‡ªåŠ¨æ–‡æ¡£ |
| **Agentæ¡†æ¶** | LangGraph | ReAct Agentã€MemorySaver |
| **LLM** | Claude 3.5 Sonnet | ä¸­æ–‡ç†è§£å¼ºã€é•¿ä¸Šä¸‹æ–‡ã€æ€§ä»·æ¯”é«˜ |
| **å¤‡ç”¨LLM** | Gemini 1.5 Flash | LingYi AI ä»£ç†æ”¯æŒ |
| **Pipeline** | Pipeline v2.1.0 | è‡ªç ”ç»Ÿä¸€å·¥å…·è¾“å‡ºæ ¼å¼ç³»ç»Ÿ |
| **å‘é‡æ•°æ®åº“** | ChromaDB | è½»é‡çº§ã€æ˜“éƒ¨ç½²ã€æ”¯æŒæœ¬åœ°è¿è¡Œ |
| **å…³ç³»æ•°æ®åº“** | PostgreSQL | æˆç†Ÿå¯é ã€æ”¯æŒJSON |
| **å…¨æ–‡æœç´¢** | SQLite FTS5 | æœ¬åœ°ç´¢å¼•ã€BM25 ç®—æ³• |
| **å®¹å™¨éš”ç¦»** | Docker | æœ¬åœ°éš”ç¦»ç¯å¢ƒæ›¿ä»£äº‘ç«¯è™šæ‹Ÿæœº |
| **MCP é›†æˆ** | Z.ai (æ™ºè°±) | Web æœç´¢ + Web è¯»å– |

---

## ğŸ”§ æ ¸å¿ƒç»„ä»¶

### 1. ContextCoordinator (v2.3.0 æ–°å¢)

**æ–‡ä»¶**: `backend/core/context_coordinator.py`

**èŒè´£**:
- ç»Ÿä¸€åè°ƒ LangGraphã€ContextManager å’Œ Memory Flush çš„äº¤äº’
- å‡†å¤‡å‘é€ç»™ LLM çš„æ¶ˆæ¯åˆ—è¡¨
- åè°ƒæ–‡ä»¶æ¸…ç†å’Œä¸Šä¸‹æ–‡æ„å»º
- ç¡®ä¿ç³»ç»Ÿæç¤ºåœ¨ç¬¬ä¸€ä½

**æ ¸å¿ƒæ–¹æ³•**:
```python
def prepare_messages(
    self,
    state_messages: List[BaseMessage],
    session_id: Optional[str] = None,
) -> List[BaseMessage]:
    """å‡†å¤‡å‘é€ç»™ LLM çš„æ¶ˆæ¯åˆ—è¡¨ï¼Œæ¸…ç†å¤§æ–‡ä»¶å†…å®¹"""

def prepare_messages_with_system_prompt(
    self,
    state_messages: List[BaseMessage],
    system_prompt: str,
    session_id: Optional[str] = None,
) -> List[BaseMessage]:
    """å‡†å¤‡æ¶ˆæ¯å¹¶ç¡®ä¿ç³»ç»Ÿæç¤ºåœ¨ç¬¬ä¸€ä½"""
```

---

### 2. ContextManager

**æ–‡ä»¶**: `backend/core/context_manager.py`

**èŒè´£**:
- æ–‡ä»¶å†…å®¹æ¸…ç†ï¼ˆè¶…è¿‡é˜ˆå€¼çš„æ–‡ä»¶å†…å®¹æ›¿æ¢ä¸ºæ¢—æ¦‚ï¼‰
- ä¸Šä¸‹æ–‡æ„å»ºï¼ˆåˆå¹¶ç³»ç»Ÿæç¤ºã€å¯¹è¯å†å²ã€æ–‡ä»¶å†…å®¹ã€ä»£ç åˆ—è¡¨ï¼‰
- ä»£ç åˆ—è¡¨ç®¡ç†

**æ ¸å¿ƒæ–¹æ³•**:
```python
def clean_file_contents(
    self,
    files: Dict[str, str],
    session_id: Optional[str] = None,
) -> Dict[str, str]:
    """æ¸…ç†å¤§æ–‡ä»¶å†…å®¹"""

def clean_langchain_messages(
    self,
    messages: List[Any],
    session_id: Optional[str] = None,
    content_threshold: int = 2000,
) -> List[Any]:
    """æ¸…ç† LangChain æ ¼å¼çš„æ¶ˆæ¯"""

def build_context(
    self,
    message: str,
    session_id: Optional[str] = None,
    file_context: Optional[Dict[str, Any]] = None,
) -> List[BaseMessage]:
    """æ„å»ºå®Œæ•´ä¸Šä¸‹æ–‡"""
```

---

### 3. LangGraph Agent

**æ–‡ä»¶**: `backend/agents/agent.py`

**èŒè´£**:
- Agent çŠ¶æ€ç®¡ç† (AgentState)
- å¯¹è¯å†å²æŒä¹…åŒ– (Checkpointer)
- å·¥å…·è°ƒç”¨å’Œç»“æœå¤„ç†
- Memory Flush è§¦å‘

**çŠ¶æ€å®šä¹‰**:
```python
class AgentState(TypedDict):
    messages: Annotated[Sequence[BaseMessage], add_messages]
    session_tokens: int
    compaction_count: int
```

**æ ¸å¿ƒæ–¹æ³•**:
```python
def call_model(state: AgentState) -> dict:
    """è°ƒç”¨ LLMï¼Œä½¿ç”¨ ContextCoordinator æ¸…ç†æ¶ˆæ¯"""

def should_continue(state: AgentState) -> Literal["tools", "end"]:
    """åˆ¤æ–­æ˜¯å¦ç»§ç»­æ‰§è¡Œå·¥å…·"""

def invoke(
    self,
    message: str,
    conversation_id: Optional[str] = None,
    session_id: Optional[str] = None,
    file_context: Optional[Dict[str, Any]] = None,
) -> Dict[str, Any]:
    """Agent ä¸»å…¥å£"""
```

---

### 4. Pipeline v2.1.0

**æ–‡ä»¶**: `backend/models/pipeline/`

**èŒè´£**:
- ç»Ÿä¸€å·¥å…·è¾“å‡ºæ ¼å¼
- è¾“å‡ºçº§åˆ«æ§åˆ¶ (BRIEF/STANDARD/FULL)
- Token è®¡æ•°
- ä¸Šä¸‹æ–‡å‹ç¼©
- å¹‚ç­‰ç¼“å­˜

**æ ¸å¿ƒç±»**:
```python
class ToolExecutionResult(BaseModel):
    """ç»Ÿä¸€å·¥å…·è¾“å‡ºæ ¼å¼"""
    output: str
    output_level: OutputLevel
    success: bool
    error: Optional[str]
    artifacts: Optional[List[Artifact]]
    metadata: Optional[Dict[str, Any]]

class OutputLevel(Enum):
    BRIEF = "brief"      # ä»…æ ¸å¿ƒç»“è®º
    STANDARD = "standard"  # æ ‡å‡†è¾“å‡º
    FULL = "full"        # å®Œæ•´è¾“å‡º

class DynamicTokenCounter:
    """å¤šæ¨¡å‹ Token è®¡æ•°"""

class AdvancedContextManager:
    """æ™ºèƒ½ä¸Šä¸‹æ–‡å‹ç¼©"""

class IdempotencyCache:
    """è·¨è½®æ¬¡è¯­ä¹‰ç¼“å­˜"""

class ToolTimeoutHandler:
    """åŒæ­¥è¶…æ—¶æ§åˆ¶"""
```

---

### 5. åŸºç¡€å·¥å…·å±‚

**æ–‡ä»¶**: `tools/`

| å·¥å…· | è¯´æ˜ | æµ‹è¯• |
|------|------|------|
| execute_command | Docker éš”ç¦»çš„å‘½ä»¤è¡Œæ‰§è¡Œ | 16/16 âœ… |
| run_python | Docker éš”ç¦»çš„ Python ä»£ç æ‰§è¡Œ | 29/29 âœ… |
| web_search | Web æœç´¢ (Z.ai MCP) | 22/22 âœ… |
| web_reader | Web è¯»å– (Z.ai MCP) | 27/27 âœ… |
| file_reader | æ–‡ä»¶è¯»å– (CSV/Excel/JSON/æ–‡æœ¬) | 61/61 âœ… |
| file_write | æ–‡ä»¶å†™å…¥ (ä¸‰ç§æ¨¡å¼) | 14/14 âœ… |
| query_database | SQL æŸ¥è¯¢ (å‚æ•°åŒ–ï¼Œå¤šæ•°æ®åº“) | 54/54 âœ… |
| search_knowledge | å‘é‡æ£€ç´¢ (ChromaDB/å†…å­˜å›é€€) | 51/51 âœ… |
| invoke_skill | Skill è°ƒç”¨ (æ¡¥æ¥ Skills) | 43/43 âœ… |
| skill_package | Skill åŒ…ç®¡ç† (GitHub/ZIP) | 43/43 âœ… |

---

### 6. Skills ç³»ç»Ÿ

**æ–‡ä»¶**: `backend/skills/`, `skills/`

**èŒè´£**:
- Skill åŠ è½½å’Œæ³¨å†Œ
- Skill æ¿€æ´»å’Œæ‰§è¡Œ
- æ¶ˆæ¯æ ¼å¼åŒ–

**é…ç½®æ–‡ä»¶**: `config/skills.yaml`

**å†…ç½® Skills**:
```yaml
skills:
  anomaly_detection:
    name: å¼‚åŠ¨æ£€æµ‹åˆ†æ
    entrypoint: skills/anomaly_detection/main.py

  attribution:
    name: å½’å› åˆ†æ
    entrypoint: skills/attribution/main.py

  report_gen:
    name: æŠ¥å‘Šç”Ÿæˆ
    entrypoint: skills/report_gen/main.py

  visualization:
    name: æ•°æ®å¯è§†åŒ–
    entrypoint: skills/visualization/main.py
```

---

### 7. è®°å¿†ç³»ç»Ÿ

**æ–‡ä»¶**: `backend/memory/`

**èŒè´£**:
- ä¸‰å±‚è®°å¿†å­˜å‚¨ (æ¯æ—¥æ—¥å¿—/é•¿æœŸçŸ¥è¯†/é¡¹ç›®çº§)
- è‡ªåŠ¨è®°å¿†æå– (MemoryFlush)
- æ–‡ä»¶ç›‘å¬å’Œç´¢å¼• (MemoryWatcher)
- æ··åˆæœç´¢ (FTS5 + å‘é‡)

**ä¸‰å±‚è®°å¿†**:
```
memory/
â”œâ”€â”€ YYYY-MM-DD.md    # Layer 1: æ¯æ—¥å¯¹è¯æ—¥å¿—
MEMORY.md            # Layer 2: é•¿æœŸçŸ¥è¯†è®°å¿†
CLAUDE.md            # Layer 3: é¡¹ç›®çº§è®°å¿†
```

---

### 8. API æœåŠ¡

**æ–‡ä»¶**: `backend/api/`

**èŒè´£**:
- FastAPI æœåŠ¡
- JWT è®¤è¯
- é€Ÿç‡é™åˆ¶
- é”™è¯¯å¤„ç†

**æ ¸å¿ƒç«¯ç‚¹**:
```python
POST /api/v1/auth/login      # JWT ç™»å½•
POST /api/v1/chat/completions # Agent å¯¹è¯
GET  /api/v1/files           # æ–‡ä»¶åˆ—è¡¨
POST /api/v1/files/upload    # æ–‡ä»¶ä¸Šä¼ 
GET  /api/v1/skills          # Skills åˆ—è¡¨
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
ba-agent/
â”œâ”€â”€ backend/                    # åç«¯æ ¸å¿ƒ
â”‚   â”œâ”€â”€ agents/                # Agent å®ç° (BAAgent + è‡ªå®šä¹‰ LangGraph)
â”‚   â”œâ”€â”€ api/                   # FastAPI æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ services/          # BA-Agent æœåŠ¡å°è£…
â”‚   â”‚   â”œâ”€â”€ routes/            # API è·¯ç”±
â”‚   â”‚   â””â”€â”€ middleware/        # JWT è®¤è¯ + é€Ÿç‡é™åˆ¶
â”‚   â”œâ”€â”€ core/                  # æ ¸å¿ƒç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ context_manager.py     # ä¸Šä¸‹æ–‡ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ context_coordinator.py  # ä¸Šä¸‹æ–‡åè°ƒå™¨ (v2.3.0 æ–°å¢)
â”‚   â”œâ”€â”€ docker/                # Docker æ²™ç›’ (DockerSandbox)
â”‚   â”œâ”€â”€ hooks/                 # ç³»ç»Ÿé’©å­
â”‚   â”œâ”€â”€ models/                # Pydantic æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ response.py        # ç»“æ„åŒ–å“åº”æ ¼å¼å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ pipeline.py        # Pipeline v2.1
â”‚   â”‚   â””â”€â”€ agent.py           # Agent çŠ¶æ€æ¨¡å‹
â”‚   â”œâ”€â”€ memory/                # è®°å¿†ç³»ç»Ÿ
â”‚   â”‚   â”œâ”€â”€ flush.py           # MemoryFlush
â”‚   â”‚   â”œâ”€â”€ index.py           # MemoryWatcher
â”‚   â”‚   â””â”€â”€ search.py          # MemorySearch
â”‚   â””â”€â”€ skills/                # Skills ç³»ç»Ÿ
â”œâ”€â”€ tools/                     # LangChain å·¥å…·
â”‚   â”œâ”€â”€ execute_command.py     # å‘½ä»¤è¡Œæ‰§è¡Œ
â”‚   â”œâ”€â”€ python_sandbox.py      # Python æ²™ç›’
â”‚   â”œâ”€â”€ web_search.py          # Web æœç´¢ (MCP)
â”‚   â”œâ”€â”€ web_reader.py          # Web Reader (MCP)
â”‚   â”œâ”€â”€ file_reader.py         # æ–‡ä»¶è¯»å–
â”‚   â”œâ”€â”€ file_write.py          # æ–‡ä»¶å†™å…¥
â”‚   â”œâ”€â”€ database.py            # SQL æŸ¥è¯¢
â”‚   â””â”€â”€ vector_search.py       # å‘é‡æ£€ç´¢
â”œâ”€â”€ skills/                    # Skills ç›®å½•
â”‚   â”œâ”€â”€ anomaly_detection/     # å¼‚åŠ¨æ£€æµ‹
â”‚   â”œâ”€â”€ attribution/           # å½’å› åˆ†æ
â”‚   â”œâ”€â”€ report_gen/            # æŠ¥å‘Šç”Ÿæˆ
â”‚   â””â”€â”€ visualization/         # æ•°æ®å¯è§†åŒ–
â”œâ”€â”€ frontend/                  # Web å‰ç«¯
â”‚   â””â”€â”€ index.html            # å•é¡µåº”ç”¨ (SPA)
â”œâ”€â”€ config/                    # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.py              # é…ç½®ç®¡ç†æ ¸å¿ƒ
â”‚   â”œâ”€â”€ settings.yaml          # ä¸»é…ç½®
â”‚   â””â”€â”€ .env                   # ç¯å¢ƒå˜é‡
â”œâ”€â”€ tests/                     # æµ‹è¯•å¥—ä»¶
â”‚   â”œâ”€â”€ core/                  # æ ¸å¿ƒç»„ä»¶æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_context_coordinator.py  # ContextCoordinator æµ‹è¯• (æ–°å¢)
â”‚   â”‚   â””â”€â”€ test_context_manager.py      # ContextManager æµ‹è¯•
â”‚   â”œâ”€â”€ tools/                 # å·¥å…·æµ‹è¯•
â”‚   â”œâ”€â”€ skills/                # Skills æµ‹è¯•
â”‚   â””â”€â”€ api/                   # API æµ‹è¯•
â”œâ”€â”€ memory/                    # æ¯æ—¥å¯¹è¯æ—¥å¿—
â”œâ”€â”€ docs/                      # æ–‡æ¡£
â”œâ”€â”€ Dockerfile                 # ä¸»æœåŠ¡é•œåƒ
â”œâ”€â”€ Dockerfile.sandbox         # Python æ²™ç›’é•œåƒ
â””â”€â”€ docker-compose.yml         # å¼€å‘ç¯å¢ƒ
```

---

## ğŸ”„ ä¸Šä¸‹æ–‡ç®¡ç†æµç¨‹

### ä¸‰å±‚åè°ƒæœºåˆ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         API Layer                                       â”‚
â”‚                   BAAgentService (ba_agent.py)                           â”‚
â”‚  - å¯¹è¯ç®¡ç† (conversation_id, message_count)                             â”‚
â”‚  - HTTP æ¥å£åŒ…è£…                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Coordination Layer                                    â”‚
â”‚                   ContextCoordinator (v2.3.0 æ–°å¢)                       â”‚
â”‚  - ç»Ÿä¸€çš„ä¸Šä¸‹æ–‡å‡†å¤‡å…¥å£                                                  â”‚
â”‚  - åè°ƒæ–‡ä»¶æ¸…ç†å’Œä¸Šä¸‹æ–‡æ„å»º                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼               â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    LangGraph        â”‚ â”‚ContextManagerâ”‚ â”‚   Memory Flush       â”‚
â”‚  (AgentState)       â”‚ â”‚              â”‚ â”‚                      â”‚
â”‚  - æ¶ˆæ¯è¿½åŠ          â”‚ â”‚ - æ–‡ä»¶æ¸…ç†   â”‚ â”‚ - Token ç›‘æ§         â”‚
â”‚  - Checkpointer     â”‚ â”‚ - ä¸Šä¸‹æ–‡æ„å»º â”‚ â”‚ - è®°å¿†æå–           â”‚
â”‚  - å¯¹è¯å†å²         â”‚ â”‚ - ä»£ç åˆ—è¡¨   â”‚ â”‚ - æŒä¹…åŒ–             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### èŒè´£åˆ’åˆ†

| å±‚çº§ | èŒè´£ | çŠ¶æ€ |
|------|------|------|
| API å±‚ | HTTP æ¥å£ã€ç®€å•è®¡æ•° | conversation_id, message_count |
| ä¸šåŠ¡å±‚ | LangGraph ç®¡ç†ã€Memory Flush | session_tokens, compaction_count |
| æ•°æ®å±‚ | å¯¹è¯å†å²æŒä¹…åŒ– | å®Œæ•´æ¶ˆæ¯åˆ—è¡¨ |

---

## ğŸ“Š å¼€å‘çŠ¶æ€

### å·²å®ŒæˆåŠŸèƒ½ (2026-02-08)

**Phase 1: Agent æ¡†æ¶** âœ…
- LangGraph + Claude Sonnet 4.5
- è‡ªå®šä¹‰å›¾ç»“æ„
- ç»“æ„åŒ–å“åº”æ ¼å¼

**Phase 2: æ ¸å¿ƒå·¥å…·** âœ…
- 9 ä¸ªåŸºç¡€å·¥å…· (303 ä¸ªæµ‹è¯•)
- Docker éš”ç¦»çš„å‘½ä»¤æ‰§è¡Œ
- MCP é›†æˆ (Web æœç´¢ + Web è¯»å–)

**Phase 3: Skills ç³»ç»Ÿ** âœ…
- Skills é…ç½®ç³»ç»Ÿ
- 4 ä¸ªå†…ç½® Skill æ¡†æ¶
- Skill åŒ…ç®¡ç†å·¥å…·

**Phase 4: Pipeline v2.1** âœ…
- ç»Ÿä¸€å·¥å…·è¾“å‡ºæ ¼å¼
- è¾“å‡ºçº§åˆ«æ§åˆ¶
- Token è®¡æ•°
- ä¸Šä¸‹æ–‡å‹ç¼©

**Phase 5: æ ¸å¿ƒä¸šåŠ¡ Skills** âœ…
- å¼‚åŠ¨æ£€æµ‹ (23 tests)
- å½’å› åˆ†æ (19 tests)
- æŠ¥å‘Šç”Ÿæˆ (19 tests)
- æ•°æ®å¯è§†åŒ– (29 tests)

**Phase 6: ä¸Šä¸‹æ–‡åè°ƒ** âœ… (v2.3.0)
- ContextCoordinator å®ç°
- ç»Ÿä¸€æ–‡ä»¶æ¸…ç†å…¥å£
- 24 ä¸ªæ–°æµ‹è¯•

**Phase 7: API æœåŠ¡** âœ…
- FastAPI æœåŠ¡
- JWT è®¤è¯
- é€Ÿç‡é™åˆ¶

**Phase 8: Web å‰ç«¯** âœ…
- å•é¡µåº”ç”¨æµ‹è¯•æ§åˆ¶å°
- Agent å¯¹è¯ç•Œé¢
- æ–‡ä»¶ç®¡ç†

### å¾…å®ç°åŠŸèƒ½ â³

- **Phase 9: IM Bot é›†æˆ** (é’‰é’‰/ä¼ä¸šå¾®ä¿¡)
- **Phase 10: Excel æ’ä»¶** (Office.js)

---

## ğŸ§ª æµ‹è¯•è¦†ç›–

### æµ‹è¯•ç»Ÿè®¡ (2026-02-08)

```
æ€»è®¡: 1030 ä¸ªæµ‹è¯•
âœ… é€šè¿‡: 1030 (100%)
â­ï¸  è·³è¿‡: 1 (MCP ç›¸å…³)
âŒ å¤±è´¥: 0
```

### æµ‹è¯•åˆ†ç±»

| ç±»åˆ« | æµ‹è¯•æ•° | çŠ¶æ€ |
|------|--------|------|
| åŸºç¡€è®¾æ–½ | 135 | âœ… |
| æ ¸å¿ƒå·¥å…· | 303 | âœ… |
| Skills ç³»ç»Ÿ | 200+ | âœ… |
| Context Coordinator | 24 | âœ… (v2.3.0 æ–°å¢) |
| Context Manager | 41 | âœ… (å¢å¼ºæµ‹è¯•) |
| Pipeline v2.1 | 100+ | âœ… |
| Memory ç³»ç»Ÿ | 120 | âœ… |
| Agent é›†æˆ | 25 | âœ… |
| API æœåŠ¡ | 36 | âœ… |
| MCP é›†æˆ | 9 | âœ… |
| FileStore ç³»ç»Ÿ | 100+ | âœ… |

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.12+
- Docker & Docker Compose
- API Keys (è‡³å°‘ä¸€ä¸ª):
  - `ANTHROPIC_API_KEY` (Claude)
  - æˆ– `GOOGLE_API_KEY` (Gemini)
  - æˆ– `ZHIPUAI_API_KEY` (æ™ºè°± GLM)

### å®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd ba-agent

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3.12 -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env å¡«å…¥ API Keys
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæµ‹è¯•
pytest tests/test_context_coordinator.py
pytest tests/tools/
```

### å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨ Docker æœåŠ¡
docker-compose up -d

# å¯åŠ¨ API æœåŠ¡
uvicorn backend.api.main:app --reload --port 8000

# è®¿é—® API æ–‡æ¡£
open http://localhost:8000/docs

# è®¿é—® Web å‰ç«¯æµ‹è¯•æ§åˆ¶å°
open http://localhost:8000
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [README.md](README.md) | äº§å“éœ€æ±‚æ–‡æ¡£ |
| [context-management.md](context-management.md) | ä¸Šä¸‹æ–‡ç®¡ç†è¯¦è§£ (v1.5.0) |
| [response-flow.md](response-flow.md) | å“åº”æ ¼å¼æµè½¬ (v2.8.0) |
| [prompts.md](prompts.md) | ç³»ç»Ÿæç¤ºè¯å®šä¹‰ |
| [skills.md](skills.md) | Skills å¼€å‘æŒ‡å— |
| [api.md](api.md) | REST API æ–‡æ¡£ (v2.3.0) |
| [development.md](development.md) | å¼€å‘æŒ‡å— (v2.3.0) |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.3.0
**æœ€åæ›´æ–°**: 2026-02-08
**ç»´æŠ¤è€…**: BA-Agent Development Team
